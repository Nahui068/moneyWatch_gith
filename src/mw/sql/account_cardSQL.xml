<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="account_card">

	<!-- 카드 정보 가져오기 -->
	<select id="card_select" resultType="cardDTO">
		select * from mwCard
	</select>
	
	<!-- 카드사 및 카드이름, 카드이미지번호-->
	<select id="card_cn" resultType="cardDTO" parameterType="String">
		select distinct company,card_name,img_cnt from mwCard where company = #{value}
	</select>
	
	<!-- 카드사 -->
	<select id="card_company" resultType="cardDTO">
		select distinct company from mwCard
	</select>
	
	<!-- 카드/계좌 DB insert -->
	<insert id="ac_insert" parameterType="accountCardDTO">
		insert into mwRegister_CA values(CAregister_seq.nextval,#{ca_set},#{id},#{ca_company},#{ca_name},#{ca_nickname})	
	</insert>

	<!-- 카드 정보 이미지 DB insert -->
	<insert id="card_img_insert" parameterType="card_imgDTO">
		insert into card_img values(card_seq.nextval,#{img_cnt},#{company},#{path})
	</insert>
	
	<!-- 카드명에 따른 카드혜택 -->
	<select id="card_benefit" resultType="cardDTO" parameterType="String">
		select * from mwCard where card_name = #{card_name}
	</select> 
	
	<!-- 카드이미지 -->
 	<select id="card_img" resultType="card_imgDTO">
		select * from card_img;
	</select>
	
	<!-- 나의 카드 및 계좌 정보 -->
	<select id="my_ac" resultType="accountCardDTO" parameterType="String">
		select * from mwRegister_CA where id=#{id}
	</select>
	
	<!-- 나의 카드 및 계좌 삭제 -->
	<delete id="my_ac_del" parameterType="hashmap">
		delete from mwRegister_CA where id=#{id} and num=#{num}
	</delete>
	
	<!-- 나의 카드혜택 보기 -->
	<select id="my_ac_benefit" resultType="cardDTO" parameterType="String">
		select * from mwCard where card_name in (select ca_name from mwRegister_CA where ca_name like '%' || #{ca_name} || '%') 
	</select>
	
	
</mapper>